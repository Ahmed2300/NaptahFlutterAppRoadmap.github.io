<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naptah Flutter App - Complete Detailed Roadmap</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üå± Naptah Flutter App - Enhanced Developer Roadmap</h1>
            <p><strong>Timeline:</strong> October 17, 2025 - November 20, 2025 (5 Weeks)</p>
            <p><strong>Team:</strong> Ahmed (Scan Features) ‚Ä¢ Mohamed (Auth & Services) ‚Ä¢ Manar (UI & Marketplace)</p>
            <div style="background: linear-gradient(135deg, #10b981, #059669); padding: 20px; border-radius: 12px; color: white; margin: 20px 0;">
                <h3 style="margin: 0 0 10px 0;">üì¶ Project Setup Required</h3>
                <p style="margin: 5px 0;"><strong>Flutter SDK:</strong> 3.16+ (Latest Stable)</p>
                <p style="margin: 5px 0;"><strong>State Management:</strong> flutter_riverpod (Recommended) or flutter_bloc</p>
                <p style="margin: 5px 0;"><strong>Navigation:</strong> go_router ^12.1.3</p>
                <p style="margin: 5px 0;"><strong>Firebase:</strong> Auth, Realtime Database, Cloud Firestore</p>
                <p style="margin: 5px 0;"><strong>Web App Reference:</strong> d:\my 1million dollar ideas\CropCare-main\src\</p>
            </div>
        </header>

        <!-- Week 1 -->
        <div class="week">
            <h2>Week 1: Core Features & UI Foundation (Oct 17 - Oct 23)</h2>
            <div class="daily-tasks">
                <div class="day-column">
                    <div class="date">Sat, Oct 17</div>
                    <div class="task" data-task-id="scan-state"><strong>Ahmed:</strong> Scan Feature State Management</div>
                    <div class="task" data-task-id="auth-service"><strong>Mohamed:</strong> Auth Service & State Management</div>
                    <div class="task" data-task-id="marketplace-service"><strong>Manar & Mohamed:</strong> Marketplace Service Layer</div>
                </div>
                <div class="day-column">
                    <div class="date">Sun, Oct 18</div>
                    <div class="task" data-task-id="scan-ui-impl"><strong>Ahmed:</strong> Scan UI Implementation</div>
                    <div class="task" data-task-id="welcome-screen-ui"><strong>Mohamed:</strong> Onboarding/Welcome Screen UI</div>
                    <div class="task" data-task-id="marketplace-main-ui"><strong>Manar:</strong> Marketplace Main UI</div>
                </div>
                <div class="day-column">
                    <div class="date">Mon, Oct 19</div>
                    <div class="task" data-task-id="camera-screen"><strong>Ahmed:</strong> Camera Screen Implementation</div>
                    <div class="task" data-task-id="app-entry-routing"><strong>Mohamed:</strong> App Entry Point & Routing Logic</div>
                    <div class="task" data-task-id="product-card-widget"><strong>Manar:</strong> Product Card Widget</div>
                </div>
                <div class="day-column">
                    <div class="date">Tue, Oct 20</div>
                    <div class="task" data-task-id="gemini-service"><strong>Ahmed:</strong> Image Analysis Service</div>
                    <div class="task" data-task-id="guest-mode"><strong>Mohamed:</strong> Guest Mode Implementation</div>
                    <div class="task" data-task-id="marketplace-state"><strong>Manar & Mohamed:</strong> Marketplace State & UI Integration</div>
                </div>
                <div class="day-column">
                    <div class="date">Wed, Oct 21</div>
                    <div class="task" data-task-id="core-analysis-logic"><strong>Ahmed:</strong> Port Core Analysis Logic</div>
                    <div class="task" data-task-id="user-profile-service"><strong>Mohamed:</strong> User Profile & Data Service</div>
                    <div class="task" data-task-id="cart-ui"><strong>Manar:</strong> Shopping Cart UI</div>
                </div>
                <div class="day-column">
                    <div class="date">Thu, Oct 22</div>
                    <div class="task" data-task-id="cart-logic"><strong>Mohamed:</strong> Shopping Cart Logic</div>
                    <div class="task" data-task-id="team-sync-1"><strong>All:</strong> Team Sync & Code Review</div>
                </div>
                <div class="day-column">
                    <div class="date">Fri, Oct 23</div>
                    <div class="task" data-task-id="checkout-ui"><strong>Manar:</strong> Checkout UI</div>
                    <div class="task" data-task-id="payment-integration"><strong>Mohamed:</strong> Payment Integration</div>
                </div>
            </div>
        </div>

        <!-- Week 2 -->
        <div class="week">
            <h2>Week 2: Community & Advanced Features (Oct 24 - Oct 30)</h2>
            <div class="daily-tasks">
                <div class="day-column">
                    <div class="date">Sat, Oct 24</div>
                    <div class="task" data-task-id="scan-history"><strong>Ahmed:</strong> Scan History & Persistence</div>
                    <div class="task" data-task-id="community-service"><strong>Mohamed:</strong> Community Service Layer</div>
                    <div class="task" data-task-id="community-main-ui"><strong>Manar:</strong> Community Screen Main UI</div>
                </div>
                <div class="day-column">
                    <div class="date">Sun, Oct 25</div>
                    <div class="task" data-task-id="results-display"><strong>Ahmed:</strong> Results Display & Product Recommendation</div>
                    <div class="task" data-task-id="community-state"><strong>Mohamed & Manar:</strong> Community State & UI Integration</div>
                    <div class="task" data-task-id="stories-ui"><strong>Ahmed:</strong> Stories Feature UI</div>
                </div>
                <div class="day-column">
                    <div class="date">Mon, Oct 26</div>
                    <div class="task" data-task-id="post-detail-comments"><strong>Ahmed:</strong> Post Detail & Comments Screen</div>
                    <div class="task" data-task-id="post-card-widget"><strong>Manar:</strong> Post Card Widget</div>
                </div>
                <div class="day-column">
                    <div class="date">Tue, Oct 27</div>
                    <div class="task" data-task-id="deep-linking-sharing"><strong>All:</strong> Deep Linking & Sharing</div>
                </div>
                <div class="day-column">
                    <div class="date">Wed, Oct 28</div>
                    <div class="task" data-task-id="feature-integration"><strong>All:</strong> Feature Integration</div>
                </div>
                <div class="day-column">
                    <div class="date">Thu, Oct 29</div>
                    <div class="task" data-task-id="team-sync-2"><strong>All:</strong> Team Sync & Code Review</div>
                </div>
                <div class="day-column">
                    <div class="date">Fri, Oct 30</div>
                    <div class="task" data-task-id="mid-demo"><strong>All:</strong> Mid-project Demo & Feedback</div>
                </div>
            </div>
        </div>

        <!-- Week 3 -->
        <div class="week">
            <h2>Week 3: Testing & Refinement (Oct 31 - Nov 6)</h2>
            <p style="background: #fef3c7; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                <strong>‚ö†Ô∏è Critical Week:</strong> This is the most important week! Focus on quality, stability, and user experience. No new features‚Äîonly testing, fixing, and optimization.
            </p>
            <div class="final-phase-tasks">
                <div class="task" data-task-id="e2e-testing"><strong>All:</strong> End-to-End Testing (Days 1-3)</div>
                <div class="task" data-task-id="performance-optimization"><strong>All:</strong> Performance Optimization (Days 3-5)</div>
                <div class="task" data-task-id="bug-fixing"><strong>All:</strong> Bug Fixing & Polish (Days 5-7)</div>
            </div>
            <div style="margin-top: 20px; padding: 15px; background: #e0f2fe; border-radius: 8px;">
                <h4 style="margin: 0 0 10px 0;">üìã Week 3 Deliverables:</h4>
                <ul style="margin: 5px 0;">
                    <li><strong>Ahmed:</strong> Complete scan feature testing (camera, AI, results, history)</li>
                    <li><strong>Mohamed:</strong> Test auth flows, payment integration, API reliability</li>
                    <li><strong>Manar:</strong> UI/UX polish, responsive design testing, accessibility</li>
                    <li><strong>All:</strong> Create test scenarios document, bug tracking spreadsheet</li>
                </ul>
            </div>
        </div>

        <!-- Week 4 -->
        <div class="week">
            <h2>Week 4: Launch & Post-Launch (Nov 7 - Nov 13)</h2>
            <p style="background: #dcfce7; padding: 15px; border-radius: 8px; border-left: 4px solid #10b981;">
                <strong>üöÄ Launch Week:</strong> Submit to app stores, monitor performance, and prepare for user feedback. Have rollback plans ready!
            </p>
            <div class="final-phase-tasks">
                <div class="task" data-task-id="app-store-prep"><strong>All:</strong> App Store Preparation (Days 1-3)</div>
                <div class="task" data-task-id="launch"><strong>All:</strong> Launch! (Day 4)</div>
                <div class="task" data-task-id="post-launch-monitoring"><strong>All:</strong> Post-Launch Monitoring (Days 5-7)</div>
            </div>
            <div style="margin-top: 20px; padding: 15px; background: #fef3c7; border-radius: 8px;">
                <h4 style="margin: 0 0 10px 0;">üì± Store Submission Checklist:</h4>
                <ul style="margin: 5px 0;">
                    <li>‚úì Screenshots (6.5" iPhone, 10.5" iPad, Android phones/tablets)</li>
                    <li>‚úì App Store descriptions (Arabic & English)</li>
                    <li>‚úì Privacy policy & terms of service URLs</li>
                    <li>‚úì App icons (1024x1024 iOS, adaptive icon Android)</li>
                    <li>‚úì Test accounts for app review</li>
                    <li>‚úì Build signed with proper certificates</li>
                </ul>
            </div>
        </div>

        <!-- Week 5 -->
        <div class="week">
            <h2>Week 5: Presentation Work (Nov 14 - Nov 20)</h2>
            <div class="daily-tasks">
                <div class="day-column">
                    <div class="date">Fri, Nov 14 - Thu, Nov 20</div>
                    <div class="task" data-task-id="presentation-creation">
                        <strong>Ahmed & Manar:</strong> Presentation Creation
                        <p>Create the presentation using Canva, including slides for the problem, solution, demo, roadmap, and team. Record voice-overs for the presentation.</p>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- ALL MODALS -->

    <!-- AHMED'S TASKS -->
    <div id="scan-state-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>üì± Scan Feature State Management Guide</h2>
        <p><strong>üë®‚Äçüíª Assignee:</strong> Ahmed | <strong>‚è±Ô∏è Estimated Time:</strong> 4-6 hours | <strong>üìÖ Day:</strong> Saturday, Oct 17</p>
        
        <h3>üéØ Goal</h3>
        <p>Set up state management for the scan screen to handle image capture, AI analysis, and results display.</p>
        
        <h3>üì¶ Required Packages</h3>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
dependencies:
  flutter_riverpod: ^2.4.9  # Recommended
  # OR
  flutter_bloc: ^8.1.3
  freezed_annotation: ^2.4.1  # For immutable state classes

dev_dependencies:
  build_runner: ^2.4.6
  freezed: ^2.4.5
        </pre>
        
        <h3>üìã Implementation Steps</h3>
        <h4>Step 1: Create Data Models (lib/data/models/)</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// scan_result.dart
class ScanResult {
  final String diseaseId;
  final String diseaseName;
  final String description;
  final double confidence;
  final String treatment;
  final String prevention;
  final bool isPlant;
  final List&lt;String&gt; affectedAreas;
  final String severity; // 'mild', 'moderate', 'severe'
  
  ScanResult({
    required this.diseaseId,
    required this.diseaseName,
    required this.description,
    required this.confidence,
    required this.treatment,
    required this.prevention,
    required this.isPlant,
    required this.affectedAreas,
    required this.severity,
  });
  
  factory ScanResult.fromJson(Map&lt;String, dynamic&gt; json) {
    // Parse Gemini API response
    return ScanResult(
      diseaseId: json['disease_id'] ?? '',
      diseaseName: json['disease_name'] ?? 'Unknown',
      // ... implement all fields
    );
  }
}
        </pre>
        
        <h4>Step 2: Define Scan State (lib/presentation/state/scan/)</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// scan_state.dart
enum ScanStatus { initial, loading, success, failure, notPlant }

class ScanState {
  final ScanStatus status;
  final ScanResult? result;
  final File? imageFile;
  final String? base64Image;  // For persistence
  final String? errorMessage;
  final int scansUsed;  // Track scan limit
  final int scanLimit;  // 5 for guest, 10 for user
  
  ScanState({
    this.status = ScanStatus.initial,
    this.result,
    this.imageFile,
    this.base64Image,
    this.errorMessage,
    this.scansUsed = 0,
    this.scanLimit = 5,
  });
  
  ScanState copyWith({
    ScanStatus? status,
    ScanResult? result,
    File? imageFile,
    String? base64Image,
    String? errorMessage,
    int? scansUsed,
    int? scanLimit,
  }) {
    return ScanState(
      status: status ?? this.status,
      result: result ?? this.result,
      imageFile: imageFile ?? this.imageFile,
      base64Image: base64Image ?? this.base64Image,
      errorMessage: errorMessage ?? this.errorMessage,
      scansUsed: scansUsed ?? this.scansUsed,
      scanLimit: scanLimit ?? this.scanLimit,
    );
  }
}
        </pre>
        
        <h4>Step 3: Create State Notifier (Riverpod Example)</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// scan_notifier.dart
class ScanNotifier extends StateNotifier&lt;ScanState&gt; {
  final GeminiService _geminiService;
  final HiveService _hiveService;
  
  ScanNotifier(this._geminiService, this._hiveService) 
      : super(ScanState());
  
  Future&lt;void&gt; analyzeImage(File imageFile) async {
    // Check scan limit
    if (state.scansUsed &gt;= state.scanLimit) {
      state = state.copyWith(
        status: ScanStatus.failure,
        errorMessage: 'Scan limit reached. Please sign in for more scans.',
      );
      return;
    }
    
    state = state.copyWith(status: ScanStatus.loading);
    
    try {
      // Convert to base64 for persistence
      final bytes = await imageFile.readAsBytes();
      final base64Image = base64Encode(bytes);
      
      // Call Gemini API
      final result = await _geminiService.analyzeImage(imageFile);
      
      // Check if it's a plant (implement fallback logic from App.tsx)
      if (!result.isPlant) {
        state = state.copyWith(
          status: ScanStatus.notPlant,
          errorMessage: 'Not a plant detected',
        );
        return;
      }
      
      // Save to history
      await _hiveService.saveScanResult(result, base64Image);
      
      state = state.copyWith(
        status: ScanStatus.success,
        result: result,
        imageFile: imageFile,
        base64Image: base64Image,
        scansUsed: state.scansUsed + 1,
      );
    } catch (e) {
      state = state.copyWith(
        status: ScanStatus.failure,
        errorMessage: e.toString(),
      );
    }
  }
  
  void reset() {
    state = ScanState();
  }
}

// Provider
final scanProvider = StateNotifierProvider&lt;ScanNotifier, ScanState&gt;((ref) {
  return ScanNotifier(
    ref.watch(geminiServiceProvider),
    ref.watch(hiveServiceProvider),
  );
});
        </pre>
        
        <h3>üìö Reference Web App Code</h3>
        <ul>
            <li><strong>File:</strong> <code>src/App.tsx</code> - Line 347-526 (handleImageAnalysis function)</li>
            <li><strong>State Pattern:</strong> Look at how React manages scan state with useState</li>
            <li><strong>Scan Limits:</strong> Line 371-385 (guest: 5 scans, user: 10 scans)</li>
        </ul>
        
        <h3>‚úÖ Testing Checklist</h3>
        <ul>
            <li>State transitions correctly (initial ‚Üí loading ‚Üí success/failure)</li>
            <li>Scan limit enforcement works</li>
            <li>Error handling displays appropriate messages</li>
            <li>Image file and base64 both stored correctly</li>
            <li>State persists across screen navigation</li>
        </ul>
        
        <h3>üîó Dependencies</h3>
        <p><strong>Required Before Starting:</strong> GeminiService structure defined, Hive initialized</p>
        <p><strong>Blocks:</strong> Scan UI Implementation, Results Display</p>
    </div></div>
    <div id="scan-ui-impl-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Scan UI Implementation Guide</h2>
        <p><strong>Goal:</strong> Build the main UI for the scan screen based on the Figma design.</p>
        <h4>Packages:</h4><ul><li>`image_picker`</li></ul>
        <h4>Steps:</h4><ol><li>Create `scan_screen.dart`.</li><li>Add buttons for "Choose from Gallery" and "Take Photo".</li><li>The "Take Photo" button will navigate to the `camera_screen.dart`.</li></ol>
    </div></div>
    <div id="camera-screen-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Camera Screen Implementation Guide</h2>
        <p><strong>Goal:</strong> Create a dedicated screen for taking photos.</p>
        <h4>Packages:</h4><ul><li>`camera`</li></ul>
        <h4>Steps:</h4><ol><li>Create `camera_screen.dart`.</li><li>Use the `camera` package to display a full-screen camera preview.</li><li>Add an overlay UI with a capture button.</li><li>On capture, pass the `XFile` back to the `scan_screen.dart`.</li></ol>
    </div></div>
    <div id="gemini-service-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>ü§ñ Gemini AI Image Analysis Service Guide</h2>
        <p><strong>üë®‚Äçüíª Assignee:</strong> Ahmed | <strong>‚è±Ô∏è Estimated Time:</strong> 6-8 hours | <strong>üìÖ Day:</strong> Tuesday, Oct 20</p>
        
        <h3>üéØ Goal</h3>
        <p>Create a robust service to communicate with Google Gemini 2.5-flash API for plant disease detection with 95% accuracy.</p>
        
        <h3>üì¶ Required Packages</h3>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
dependencies:
  http: ^1.1.0
  dart:convert  # Built-in
  dart:io       # Built-in
        </pre>
        
        <h3>üîë API Configuration</h3>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// .env file
GEMINI_API_KEYS=key1,key2,key3  # Multiple keys for rotation
        </pre>
        
        <h3>üìã Implementation Steps</h3>
        <h4>Step 1: Create Gemini Service (lib/data/services/)</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// gemini_service.dart
import 'dart:convert';
import 'dart:io';
import 'package:http/http.dart' as http;

class GeminiService {
  static const String _baseUrl = 
      'https://generativelanguage.googleapis.com/v1beta/models';
  static const String _model = 'gemini-2.0-flash-exp';
  
  final List&lt;String&gt; _apiKeys;
  int _currentKeyIndex = 0;
  
  GeminiService(this._apiKeys);
  
  String get _currentApiKey =&gt; _apiKeys[_currentKeyIndex];
  
  void _rotateApiKey() {
    _currentKeyIndex = (_currentKeyIndex + 1) % _apiKeys.length;
    print('üîÑ Rotated to API key ${_currentKeyIndex + 1}');
  }
  
  Future&lt;ScanResult&gt; analyzeImage(File imageFile) async {
    final bytes = await imageFile.readAsBytes();
    final base64Image = base64Encode(bytes);
    
    // Construct prompt (Egyptian climate-focused)
    final prompt = '''
Analyze this plant image and provide a detailed diagnosis in JSON format.
Focus on diseases common in Egypt's climate.

Required JSON structure:
{
  "is_plant": true/false,
  "disease_id": "unique_id",
  "disease_name": "Disease Name",
  "description": "Detailed description",
  "confidence": 0.95,
  "treatment": "Treatment steps...",
  "prevention": "Prevention tips...",
  "affected_areas": ["leaves", "stems"],
  "severity": "mild|moderate|severe",
  "recommended_products": ["product1", "product2"]
}

If not a plant, return: {"is_plant": false}
    ''';
    
    final requestBody = {
      'contents': [
        {
          'parts': [
            {'text': prompt},
            {
              'inline_data': {
                'mime_type': 'image/jpeg',
                'data': base64Image,
              }
            }
          ]
        }
      ],
      'generationConfig': {
        'temperature': 0.4,
        'topK': 32,
        'topP': 1,
        'maxOutputTokens': 2048,
      }
    };
    
    final url = Uri.parse(
      '$_baseUrl/$_model:generateContent?key=$_currentApiKey'
    );
    
    try {
      final response = await http.post(
        url,
        headers: {'Content-Type': 'application/json'},
        body: jsonEncode(requestBody),
      );
      
      if (response.statusCode == 200) {
        final data = jsonDecode(response.body);
        final text = data['candidates'][0]['content']['parts'][0]['text'];
        
        // Extract JSON from markdown code blocks if present
        final jsonMatch = RegExp(r'```json\s*(\{.*?\})\s*```', 
            dotAll: true).firstMatch(text);
        final jsonStr = jsonMatch?.group(1) ?? text;
        
        final resultJson = jsonDecode(jsonStr);
        return ScanResult.fromJson(resultJson);
        
      } else if (response.statusCode == 429) {
        // Quota exceeded - rotate key and retry
        print('‚ö†Ô∏è API quota exceeded, rotating key...');
        _rotateApiKey();
        return analyzeImage(imageFile); // Retry with next key
        
      } else {
        throw Exception('API Error: ${response.statusCode}');
      }
    } catch (e) {
      throw Exception('Failed to analyze image: $e');
    }
  }
}

// Provider
final geminiServiceProvider = Provider&lt;GeminiService&gt;((ref) {
  final apiKeys = dotenv.env['GEMINI_API_KEYS']!.split(',');
  return GeminiService(apiKeys);
});
        </pre>
        
        <h4>Step 2: Implement "Is Plant" Fallback Logic</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// Port from App.tsx lines 476-511
bool _checkPlantKeywords(String description) {
  final plantKeywords = [
    'leaf', 'leaves', 'plant', 'stem', 'root', 'flower',
    'pest', 'disease', 'fungus', 'bacteria', 'virus',
    'nutrient', 'deficiency', 'chlorosis', 'necrosis',
    'wilt', 'blight', 'rot', 'mold', 'mildew'
  ];
  
  final lowerDesc = description.toLowerCase();
  return plantKeywords.any((keyword) =&gt; lowerDesc.contains(keyword));
}

// In analyzeImage method, after getting result:
if (!result.isPlant) {
  // Fallback check using keywords
  final hasPlantKeywords = _checkPlantKeywords(
    result.description ?? ''
  );
  
  if (hasPlantKeywords) {
    print('üîÑ Overriding is_plant=false based on keywords');
    result = result.copyWith(isPlant: true);
  }
}
        </pre>
        
        <h3>üß™ Testing Strategy</h3>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
// gemini_service_test.dart
void main() {
  group('GeminiService', () {
    test('analyzes plant disease successfully', () async {
      final service = GeminiService(['test_key']);
      final file = File('test_assets/diseased_plant.jpg');
      
      final result = await service.analyzeImage(file);
      
      expect(result.isPlant, true);
      expect(result.diseaseName, isNotEmpty);
      expect(result.confidence, greaterThan(0.5));
    });
    
    test('handles non-plant images', () async {
      final service = GeminiService(['test_key']);
      final file = File('test_assets/not_plant.jpg');
      
      final result = await service.analyzeImage(file);
      
      expect(result.isPlant, false);
    });
    
    test('rotates API keys on quota exceeded', () async {
      // Mock HTTP client to return 429
      final service = GeminiService(['key1', 'key2', 'key3']);
      // Test key rotation logic
    });
  });
}
        </pre>
        
        <h3>üìö Reference Web App Code</h3>
        <ul>
            <li><strong>File:</strong> <code>src/App.tsx</code> - Lines 427-526</li>
            <li><strong>API Call:</strong> Lines 435-467 (Gemini API request structure)</li>
            <li><strong>Key Rotation:</strong> Lines 56-60 (getCurrentApiKey function)</li>
            <li><strong>Fallback Logic:</strong> Lines 476-511 (isPlant keyword check)</li>
        </ul>
        
        <h3>‚ö†Ô∏è Critical Considerations</h3>
        <ul>
            <li><strong>API Key Rotation:</strong> Implement automatic rotation on 429 errors</li>
            <li><strong>Image Size:</strong> Compress images >2MB before encoding</li>
            <li><strong>Timeout:</strong> Set 30-second timeout for API calls</li>
            <li><strong>Error Messages:</strong> Provide user-friendly error messages in Arabic/English</li>
            <li><strong>Caching:</strong> Consider caching results for identical images (optional)</li>
        </ul>
        
        <h3>‚úÖ Testing Checklist</h3>
        <ul>
            <li>‚úì Successfully analyzes plant disease images</li>
            <li>‚úì Returns accurate confidence scores (&gt;90%)</li>
            <li>‚úì Handles non-plant images correctly</li>
            <li>‚úì API key rotation works on quota exceeded</li>
            <li>‚úì Fallback keyword logic overrides false negatives</li>
            <li>‚úì Error handling for network issues</li>
            <li>‚úì Proper JSON parsing from Gemini response</li>
        </ul>
        
        <h3>üîó Dependencies</h3>
        <p><strong>Required:</strong> ScanResult model, .env configuration</p>
        <p><strong>Blocks:</strong> Core Analysis Logic, Results Display</p>
    </div></div>
    <div id="core-analysis-logic-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Port Core Analysis Logic Guide</h2>
        <p><strong>Goal:</strong> Replicate the `handleImageAnalysis` logic from `App.tsx`.</p>
        <h4>Steps:</h4><ol><li><strong>Port Scan Limit Logic:</strong> Before calling the API, check if the user has exceeded their scan limit.</li><li><strong>Port "Is Plant" Fallback Logic:</strong> After receiving the analysis, if `is_plant` is false, implement the same keyword-based check from `App.tsx` to override the result if necessary.</li><li><strong>Update State:</strong> Update the `ScanState` to `success`, `failure`, or `notPlant` to trigger the correct UI.</li></ol>
    </div></div>
    <div id="scan-history-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Scan History & Persistence Guide</h2>
        <p><strong>Goal:</strong> Save scan results locally.</p>
        <h4>Packages:</h4><ul><li>`hive`</li><li>`hive_flutter`</li></ul>
        <h4>Steps:</h4><ol><li>Initialize Hive in `main.dart`.</li><li>On successful analysis, save the result object and the base64 encoded image string to a Hive box.</li><li>Create a `history_screen.dart` to display past scans.</li></ol>
    </div></div>
    <div id="results-display-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Results Display & Product Recommendation Guide</h2>
        <p><strong>Goal:</strong> Display analysis results and recommend products.</p>
        <h4>Packages:</h4><ul><li>`url_launcher`</li></ul>
        <h4>Steps:</h4><ol><li>Create `scan_results_screen.dart`.</li><li>Display all information from the analysis result based on the Figma design.</li><li><strong>Recommendation Logic:</strong> Query the marketplace data. If a matching product is found, navigate to its page. If not, use `url_launcher` to perform a Google search for the treatment.</li></ol>
    </div></div>

    <!-- MOHAMED'S TASKS -->
    <div id="auth-service-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>üîê Authentication Service & State Management Guide</h2>
        <p><strong>üë®‚Äçüíª Assignee:</strong> Mohamed | <strong>‚è±Ô∏è Estimated Time:</strong> 6-8 hours | <strong>üìÖ Day:</strong> Saturday, Oct 17</p>
        
        <h3>üéØ Goal</h3>
        <p>Create a robust authentication system with Firebase Auth, Google Sign-in, and guest mode support.</p>
        
        <h3>üì¶ Required Packages</h3>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
dependencies:
  firebase_core: ^2.24.2
  firebase_auth: ^4.15.3
  google_sign_in: ^6.1.6
  flutter_riverpod: ^2.4.9
  shared_preferences: ^2.2.2  # For guest mode flag
        </pre>
        
        <h3>üîß Firebase Setup</h3>
        <h4>Step 1: Configure Firebase Project</h4>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
# Install Firebase CLI
npm install -g firebase-tools

# Login to Firebase
firebase login

# Initialize Firebase in your Flutter project
flutterfire configure
        </pre>
        
        <h4>Step 2: Enable Authentication Providers</h4>
        <ul>
            <li>Go to Firebase Console ‚Üí Authentication ‚Üí Sign-in method</li>
            <li>Enable <strong>Google</strong> sign-in provider</li>
            <li>Enable <strong>Anonymous</strong> for guest mode</li>
            <li>Add SHA-1 and SHA-256 fingerprints for Android</li>
        </ul>
        
        <h3>üìã Implementation Steps</h3>
        <h4>Step 1: Create Auth Service (lib/data/services/)</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// auth_service.dart
import 'package:firebase_auth/firebase_auth.dart';
import 'package:google_sign_in/google_sign_in.dart';
import 'package:shared_preferences/shared_preferences.dart';

class AuthService {
  final FirebaseAuth _auth = FirebaseAuth.instance;
  final GoogleSignIn _googleSignIn = GoogleSignIn();
  final SharedPreferences _prefs;
  
  AuthService(this._prefs);
  
  // Stream of auth state changes
  Stream&lt;User?&gt; get authStateChanges =&gt; _auth.authStateChanges();
  
  // Get current user
  User? get currentUser =&gt; _auth.currentUser;
  
  // Check if user is guest
  bool get isGuestMode =&gt; _prefs.getBool('is_guest') ?? false;
  
  // Get scan limit based on user type
  int get scanLimit {
    if (isGuestMode) return 5;
    if (currentUser != null) return 10;
    return 5;
  }
  
  /// Sign in with Google
  Future&lt;UserCredential?&gt; signInWithGoogle() async {
    try {
      // Trigger Google Sign In flow
      final GoogleSignInAccount? googleUser = await _googleSignIn.signIn();
      
      if (googleUser == null) {
        // User cancelled the sign-in
        return null;
      }
      
      // Obtain auth details
      final GoogleSignInAuthentication googleAuth = 
          await googleUser.authentication;
      
      // Create credential
      final credential = GoogleAuthProvider.credential(
        accessToken: googleAuth.accessToken,
        idToken: googleAuth.idToken,
      );
      
      // Sign in to Firebase
      final userCredential = await _auth.signInWithCredential(credential);
      
      // Clear guest mode flag
      await _prefs.setBool('is_guest', false);
      
      // Create user profile in Firestore/RTDB if first time
      await _createUserProfile(userCredential.user!);
      
      return userCredential;
      
    } catch (e) {
      print('‚ùå Sign in error: $e');
      rethrow;
    }
  }
  
  /// Continue as guest (anonymous auth)
  Future&lt;void&gt; continueAsGuest() async {
    try {
      // Set guest flag
      await _prefs.setBool('is_guest', true);
      
      // Don't actually sign in, just allow limited access
      // OR use Firebase anonymous auth:
      // await _auth.signInAnonymously();
      
    } catch (e) {
      print('‚ùå Guest mode error: $e');
      rethrow;
    }
  }
  
  /// Sign out
  Future&lt;void&gt; signOut() async {
    try {
      await _googleSignIn.signOut();
      await _auth.signOut();
      await _prefs.setBool('is_guest', false);
    } catch (e) {
      print('‚ùå Sign out error: $e');
      rethrow;
    }
  }
  
  /// Create user profile in database
  Future&lt;void&gt; _createUserProfile(User user) async {
    final userRef = FirebaseDatabase.instance
        .ref('users/${user.uid}');
    
    final snapshot = await userRef.get();
    
    if (!snapshot.exists) {
      // First time user - create profile
      await userRef.set({
        'uid': user.uid,
        'email': user.email,
        'displayName': user.displayName,
        'photoURL': user.photoURL,
        'createdAt': ServerValue.timestamp,
        'reputation': 0,
        'level': 'Newcomer',
        'totalScans': 0,
        'totalPosts': 0,
        'badges': [],
      });
      
      print('‚úÖ Created user profile for ${user.displayName}');
    }
  }
}
        </pre>
        
        <h4>Step 2: Create Riverpod Providers</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// auth_providers.dart
import 'package:flutter_riverpod/flutter_riverpod.dart';

// Shared Preferences Provider
final sharedPreferencesProvider = Provider&lt;SharedPreferences&gt;((ref) {
  throw UnimplementedError('Override in main.dart');
});

// Auth Service Provider
final authServiceProvider = Provider&lt;AuthService&gt;((ref) {
  final prefs = ref.watch(sharedPreferencesProvider);
  return AuthService(prefs);
});

// Auth State Stream Provider
final authStateProvider = StreamProvider&lt;User?&gt;((ref) {
  final authService = ref.watch(authServiceProvider);
  return authService.authStateChanges;
});

// Current User Provider
final currentUserProvider = Provider&lt;User?&gt;((ref) {
  final authState = ref.watch(authStateProvider);
  return authState.when(
    data: (user) =&gt; user,
    loading: () =&gt; null,
    error: (_, __) =&gt; null,
  );
});

// Guest Mode Provider
final isGuestModeProvider = Provider&lt;bool&gt;((ref) {
  final authService = ref.watch(authServiceProvider);
  return authService.isGuestMode;
});

// Scan Limit Provider
final scanLimitProvider = Provider&lt;int&gt;((ref) {
  final authService = ref.watch(authServiceProvider);
  return authService.scanLimit;
});
        </pre>
        
        <h4>Step 3: Initialize in main.dart</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// main.dart
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  // Initialize Firebase
  await Firebase.initializeApp(
    options: DefaultFirebaseOptions.currentPlatform,
  );
  
  // Initialize SharedPreferences
  final prefs = await SharedPreferences.getInstance();
  
  runApp(
    ProviderScope(
      overrides: [
        sharedPreferencesProvider.overrideWithValue(prefs),
      ],
      child: MyApp(),
    ),
  );
}
        </pre>
        
        <h3>üé® UI Integration Example</h3>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// welcome_screen.dart
class WelcomeScreen extends ConsumerWidget {
  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final authService = ref.watch(authServiceProvider);
    
    return Scaffold(
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            // Google Sign In Button
            ElevatedButton.icon(
              icon: Icon(Icons.login),
              label: Text('Sign in with Google'),
              onPressed: () async {
                try {
                  await authService.signInWithGoogle();
                  // Navigation handled by GoRouter redirect
                } catch (e) {
                  ScaffoldMessenger.of(context).showSnackBar(
                    SnackBar(content: Text('Sign in failed: $e')),
                  );
                }
              },
            ),
            
            SizedBox(height: 16),
            
            // Guest Mode Button
            TextButton(
              child: Text('Continue as Guest (5 free scans)'),
              onPressed: () async {
                await authService.continueAsGuest();
                Navigator.pushReplacementNamed(context, '/scan');
              },
            ),
          ],
        ),
      ),
    );
  }
}
        </pre>
        
        <h3>üìö Reference Web App Code</h3>
        <ul>
            <li><strong>File:</strong> <code>src/lib/firebase.ts</code> - Firebase configuration</li>
            <li><strong>Auth Context:</strong> <code>src/contexts/AuthContext.tsx</code> - Lines 1-150</li>
            <li><strong>Protected Route:</strong> <code>src/App.tsx</code> - Lines 156-197 (ProtectedRoute component)</li>
            <li><strong>Guest Mode:</strong> <code>src/App.tsx</code> - Lines 345-385 (scan limit logic)</li>
        </ul>
        
        <h3>üîê Security Best Practices</h3>
        <ul>
            <li><strong>Never hardcode API keys</strong> - Use environment variables</li>
            <li><strong>Validate user tokens</strong> on backend for sensitive operations</li>
            <li><strong>Implement proper error handling</strong> for network failures</li>
            <li><strong>Use secure storage</strong> for sensitive user data</li>
            <li><strong>Add biometric auth</strong> for quick sign-in (optional enhancement)</li>
        </ul>
        
        <h3>‚úÖ Testing Checklist</h3>
        <ul>
            <li>‚úì Google Sign-in flow works on Android &amp; iOS</li>
            <li>‚úì Guest mode allows limited app access</li>
            <li>‚úì Sign out clears all user data</li>
            <li>‚úì Auth state persists across app restarts</li>
            <li>‚úì Scan limits enforced correctly (5 guest, 10 user)</li>
            <li>‚úì User profile created on first sign-in</li>
            <li>‚úì Error messages displayed properly</li>
        </ul>
        
        <h3>üîó Dependencies</h3>
        <p><strong>Required:</strong> Firebase project setup, Google Sign-in configuration</p>
        <p><strong>Blocks:</strong> App Entry Routing, User Profile Service, Scan Limit Logic</p>
    </div></div>
    <div id="welcome-screen-ui-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Onboarding/Welcome Screen UI Guide</h2>
        <p><strong>Goal:</strong> Build the initial screen for new users based on the Figma design.</p>
        <h4>Steps:</h4><ol><li>Create `welcome_screen.dart`.</li><li>Implement the UI from Figma.</li><li>Add "Sign in with Google" and "Continue as Guest" buttons.</li></ol>
    </div></div>
    <div id="app-entry-routing-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>App Entry Point & Routing Logic Guide</h2>
        <p><strong>Goal:</strong> Replicate the logic from `ProtectedRoute` to direct users on app startup.</p>
        <h4>Packages:</h4><ul><li>`go_router`</li></ul>
        <h4>Steps:</h4><ol><li>In your router configuration, listen to the auth state stream.</li><li>Use `go_router`'s `redirect` functionality.</li><li>While loading, show a spinner. If user exists, redirect to `/scan`. If null, redirect to `/welcome`.</li></ol>
    </div></div>
    <div id="guest-mode-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Guest Mode Implementation Guide</h2>
        <p><strong>Goal:</strong> Allow users to use the app with limited functionality.</p>
        <h4>Steps:</h4><ol><li>When "Continue as Guest" is tapped, set a flag (e.g., in a Riverpod provider) to `true`.</li><li>In other parts of the app, check this flag to enforce limitations.</li></ol>
    </div></div>
    <div id="user-profile-service-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>User Profile & Data Service Guide</h2>
        <p><strong>Goal:</strong> Create a service to manage user profile data in Firebase.</p>
        <h4>Packages:</h4><ul><li>`cloud_firestore` or `firebase_database`</li></ul>
        <h4>Steps:</h4><ol><li>Create `user_service.dart`.</li><li>On first sign-in, create a profile document for the user.</li><li>Create a method to fetch a user's profile.</li><li>Implement the UI for `profile_screen.dart`.</li></ol>
    </div></div>

    <!-- MANAR & MOHAMED'S TASKS -->
    <div id="marketplace-service-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Marketplace Service Layer Guide</h2>
        <p><strong>Assignee:</strong> Mohamed</p>
        <p><strong>Goal:</strong> Create a service to handle all communication with Firebase for marketplace features.</p>
        <h4>Packages:</h4><ul><li>`cloud_firestore` or `firebase_database`</li></ul>
        <h4>Steps:</h4><ol><li>Create `marketplace_service.dart`.</li><li>Implement `getProducts()`, `searchProducts(String query)`, `getCart()`, `addToCart(String productId)`, `removeFromCart(String cartItemId)`, and `createOrder()`.</li></ol>
    </div></div>
    <div id="marketplace-main-ui-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Marketplace Main UI Guide</h2>
        <p><strong>Assignee:</strong> Manar</p>
        <p><strong>Goal:</strong> Build the main marketplace screen UI based on the Figma design.</p>
        <h4>Steps:</h4><ol><li>Create `marketplace_screen.dart`.</li><li>Implement the header, search bar, filter/sort options, category sidebar, and view toggle.</li></ol>
    </div></div>
    <div id="product-card-widget-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Product Card Widget Guide</h2>
        <p><strong>Assignee:</strong> Manar</p>
        <p><strong>Goal:</strong> Create a reusable widget for displaying a single product.</p>
        <h4>Steps:</h4><ol><li>Create `product_card.dart`.</li><li>Display all product information based on the Figma design.</li><li>Ensure the widget can adapt for both grid and list views.</li></ol>
    </div></div>
    <div id="marketplace-state-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Marketplace State & UI Integration Guide</h2>
        <p><strong>Assignees:</strong> Manar & Mohamed</p>
        <p><strong>Goal:</strong> Connect the UI to the service layer and manage the screen's state.</p>
        <h4>Steps:</h4><ol><li><strong>(Mohamed)</strong> Create a BLoC/Notifier to manage the marketplace state.</li><li><strong>(Manar)</strong> Connect the UI widgets to the state management solution.</li><li><strong>(Mohamed)</strong> Implement the `onPressed` logic for the "Add to Cart" button.</li></ol>
    </div></div>
    <div id="cart-ui-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Shopping Cart UI Guide</h2>
        <p><strong>Assignee:</strong> Manar</p>
        <p><strong>Goal:</strong> Build the UI for the shopping cart screen.</p>
        <h4>Steps:</h4><ol><li>Create `cart_screen.dart`.</li><li>Display a list of items, quantity changers, and a total price.</li></ol>
    </div></div>
    <div id="cart-logic-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Shopping Cart Logic Guide</h2>
        <p><strong>Assignee:</strong> Mohamed</p>
        <p><strong>Goal:</strong> Implement the business logic for the shopping cart.</p>
        <h4>Steps:</h4><ol><li>Create a `CartBLoC` or `CartNotifier`.</li><li>Implement methods to fetch, update, and remove cart items by calling the `MarketplaceService`.</li></ol>
    </div></div>
    <div id="checkout-ui-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Checkout UI Guide</h2>
        <p><strong>Assignee:</strong> Manar</p>
        <p><strong>Goal:</strong> Build the UI for the checkout process.</p>
        <h4>Steps:</h4><ol><li>Create `checkout_screen.dart`.</li><li>Design forms for shipping address and payment selection.</li></ol>
    </div></div>
    <div id="payment-integration-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Payment Integration Guide</h2>
        <p><strong>Assignee:</strong> Mohamed</p>
        <p><strong>Goal:</strong> Integrate the PayPal payment gateway.</p>
        <h4>Packages:</h4><ul><li>`flutter_paypal` or `webview_flutter`</li></ul>
        <h4>Steps:</h4><ol><li>Use a package or webview to handle the PayPal flow.</li><li>On success, call `createOrder()` in the `MarketplaceService`.</li></ol>
    </div></div>

    <!-- COMMUNITY TASKS -->
    <div id="community-service-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>üë• Community Service Layer Guide</h2>
        <p><strong>üë®‚Äçüíª Assignee:</strong> Mohamed | <strong>‚è±Ô∏è Estimated Time:</strong> 8-10 hours | <strong>üìÖ Day:</strong> Saturday, Oct 24</p>
        
        <h3>üéØ Goal</h3>
        <p>Create a comprehensive service layer for community features with real-time updates, voting system, and posts management.</p>
        
        <h3>üì¶ Required Packages</h3>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
dependencies:
  firebase_database: ^10.3.8
  cloud_firestore: ^4.13.6  # Optional, for posts
  intl: ^0.18.1  # For date formatting
        </pre>
        
        <h3>üìä Firebase Database Structure</h3>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
/posts
  /{postId}
    - id: string
    - title: string
    - content: string
    - authorId: string
    - authorName: string
    - authorPhotoURL: string
    - channel: string (#Plant-Diagnosis, #Gardening-Guides, #General)
    - imageUrl: string?
    - votes: number
    - commentCount: number
    - createdAt: timestamp
    - updatedAt: timestamp

/comments
  /{commentId}
    - id: string
    - postId: string
    - authorId: string
    - authorName: string
    - content: string
    - votes: number
    - createdAt: timestamp

/stories
  /{storyId}
    - id: string
    - authorId: string
    - authorName: string
    - authorPhotoURL: string
    - imageUrl: string
    - caption: string
    - views: number
    - hearts: number
    - createdAt: timestamp
    - expiresAt: timestamp (24 hours)

/votes
  /posts/{postId}/{userId}: 1 or -1
  /comments/{commentId}/{userId}: 1 or -1
        </pre>
        
        <h3>üìã Implementation Steps</h3>
        <h4>Step 1: Create Data Models (lib/data/models/)</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// post.dart
class Post {
  final String id;
  final String title;
  final String content;
  final String authorId;
  final String authorName;
  final String? authorPhotoURL;
  final String channel;
  final String? imageUrl;
  final int votes;
  final int commentCount;
  final DateTime createdAt;
  final DateTime updatedAt;
  
  Post({
    required this.id,
    required this.title,
    required this.content,
    required this.authorId,
    required this.authorName,
    this.authorPhotoURL,
    required this.channel,
    this.imageUrl,
    required this.votes,
    this.commentCount = 0,
    required this.createdAt,
    required this.updatedAt,
  });
  
  factory Post.fromJson(String id, Map&lt;String, dynamic&gt; json) {
    return Post(
      id: id,
      title: json['title'] ?? '',
      content: json['content'] ?? '',
      authorId: json['authorId'] ?? '',
      authorName: json['authorName'] ?? 'Anonymous',
      authorPhotoURL: json['authorPhotoURL'],
      channel: json['channel'] ?? '#General-Discussion',
      imageUrl: json['imageUrl'],
      votes: json['votes'] ?? 0,
      commentCount: json['commentCount'] ?? 0,
      createdAt: DateTime.fromMillisecondsSinceEpoch(
        json['createdAt'] ?? 0
      ),
      updatedAt: DateTime.fromMillisecondsSinceEpoch(
        json['updatedAt'] ?? 0
      ),
    );
  }
  
  Map&lt;String, dynamic&gt; toJson() {
    return {
      'title': title,
      'content': content,
      'authorId': authorId,
      'authorName': authorName,
      'authorPhotoURL': authorPhotoURL,
      'channel': channel,
      'imageUrl': imageUrl,
      'votes': votes,
      'commentCount': commentCount,
      'createdAt': ServerValue.timestamp,
      'updatedAt': ServerValue.timestamp,
    };
  }
}

// comment.dart
class Comment {
  final String id;
  final String postId;
  final String authorId;
  final String authorName;
  final String? authorPhotoURL;
  final String content;
  final int votes;
  final DateTime createdAt;
  
  // Constructor and fromJson/toJson methods...
}

// story.dart
class Story {
  final String id;
  final String authorId;
  final String authorName;
  final String? authorPhotoURL;
  final String imageUrl;
  final String caption;
  final int views;
  final int hearts;
  final DateTime createdAt;
  final DateTime expiresAt;
  
  bool get isExpired => DateTime.now().isAfter(expiresAt);
  
  // Constructor and fromJson/toJson methods...
}
        </pre>
        
        <h4>Step 2: Create Community Service (lib/data/services/)</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// community_service.dart
import 'package:firebase_database/firebase_database.dart';

class CommunityService {
  final FirebaseDatabase _db = FirebaseDatabase.instance;
  
  /// Get posts stream with real-time updates
  Stream&lt;List&lt;Post&gt;&gt; getPosts({
    String? channel,
    int limit = 20,
  }) {
    Query query = _db.ref('posts');
    
    // Filter by channel if specified
    if (channel != null) {
      query = query.orderByChild('channel').equalTo(channel);
    } else {
      query = query.orderByChild('createdAt');
    }
    
    return query.limitToLast(limit).onValue.map((event) {
      final List&lt;Post&gt; posts = [];
      
      if (event.snapshot.value != null) {
        final data = event.snapshot.value as Map&lt;dynamic, dynamic&gt;;
        
        data.forEach((key, value) {
          posts.add(Post.fromJson(
            key.toString(),
            Map&lt;String, dynamic&gt;.from(value as Map),
          ));
        });
      }
      
      // Sort by newest first
      posts.sort((a, b) =&gt; b.createdAt.compareTo(a.createdAt));
      
      return posts;
    });
  }
  
  /// Create a new post
  Future&lt;String&gt; createPost({
    required String title,
    required String content,
    required String channel,
    required String authorId,
    required String authorName,
    String? authorPhotoURL,
    String? imageUrl,
  }) async {
    final postRef = _db.ref('posts').push();
    
    final post = Post(
      id: postRef.key!,
      title: title,
      content: content,
      authorId: authorId,
      authorName: authorName,
      authorPhotoURL: authorPhotoURL,
      channel: channel,
      imageUrl: imageUrl,
      votes: 0,
      createdAt: DateTime.now(),
      updatedAt: DateTime.now(),
    );
    
    await postRef.set(post.toJson());
    
    // Update user stats
    await _updateUserStats(authorId, postsCreated: 1);
    
    return postRef.key!;
  }
  
  /// Vote on a post (using Firebase Transaction)
  Future&lt;void&gt; voteOnPost(String postId, String userId, int voteValue) async {
    final postRef = _db.ref('posts/$postId');
    final voteRef = _db.ref('votes/posts/$postId/$userId');
    
    // Run transaction to prevent race conditions
    await postRef.runTransaction((Object? post) {
      if (post == null) return Transaction.abort();
      
      final postData = Map&lt;String, dynamic&gt;.from(post as Map);
      final currentVotes = postData['votes'] ?? 0;
      
      // Get previous vote
      voteRef.get().then((snapshot) async {
        final previousVote = snapshot.value as int? ?? 0;
        
        // Calculate vote change
        final voteDelta = voteValue - previousVote;
        
        // Update post votes
        postData['votes'] = currentVotes + voteDelta;
        
        // Save user's vote
        if (voteValue == 0) {
          await voteRef.remove();
        } else {
          await voteRef.set(voteValue);
        }
      });
      
      return Transaction.success(postData);
    });
  }
  
  /// Get comments for a post
  Stream&lt;List&lt;Comment&gt;&gt; getComments(String postId) {
    return _db
        .ref('comments')
        .orderByChild('postId')
        .equalTo(postId)
        .onValue
        .map((event) {
      final List&lt;Comment&gt; comments = [];
      
      if (event.snapshot.value != null) {
        final data = event.snapshot.value as Map&lt;dynamic, dynamic&gt;;
        
        data.forEach((key, value) {
          comments.add(Comment.fromJson(
            key.toString(),
            Map&lt;String, dynamic&gt;.from(value as Map),
          ));
        });
      }
      
      comments.sort((a, b) =&gt; a.createdAt.compareTo(b.createdAt));
      return comments;
    });
  }
  
  /// Add comment to post
  Future&lt;String&gt; addComment({
    required String postId,
    required String content,
    required String authorId,
    required String authorName,
    String? authorPhotoURL,
  }) async {
    final commentRef = _db.ref('comments').push();
    
    final comment = Comment(
      id: commentRef.key!,
      postId: postId,
      authorId: authorId,
      authorName: authorName,
      authorPhotoURL: authorPhotoURL,
      content: content,
      votes: 0,
      createdAt: DateTime.now(),
    );
    
    await commentRef.set(comment.toJson());
    
    // Increment comment count on post
    final postRef = _db.ref('posts/$postId/commentCount');
    await postRef.runTransaction((Object? count) {
      return Transaction.success((count ?? 0) + 1);
    });
    
    return commentRef.key!;
  }
  
  /// Create a story (expires in 24 hours)
  Future&lt;String&gt; createStory({
    required String authorId,
    required String authorName,
    String? authorPhotoURL,
    required String imageUrl,
    required String caption,
  }) async {
    final storyRef = _db.ref('stories').push();
    
    final story = Story(
      id: storyRef.key!,
      authorId: authorId,
      authorName: authorName,
      authorPhotoURL: authorPhotoURL,
      imageUrl: imageUrl,
      caption: caption,
      views: 0,
      hearts: 0,
      createdAt: DateTime.now(),
      expiresAt: DateTime.now().add(Duration(hours: 24)),
    );
    
    await storyRef.set(story.toJson());
    
    return storyRef.key!;
  }
  
  /// Get active stories (not expired)
  Stream&lt;List&lt;Story&gt;&gt; getActiveStories() {
    final now = DateTime.now();
    
    return _db
        .ref('stories')
        .orderByChild('expiresAt')
        .startAt(now.millisecondsSinceEpoch)
        .onValue
        .map((event) {
      final List&lt;Story&gt; stories = [];
      
      if (event.snapshot.value != null) {
        final data = event.snapshot.value as Map&lt;dynamic, dynamic&gt;;
        
        data.forEach((key, value) {
          final story = Story.fromJson(
            key.toString(),
            Map&lt;String, dynamic&gt;.from(value as Map),
          );
          
          if (!story.isExpired) {
            stories.add(story);
          }
        });
      }
      
      stories.sort((a, b) =&gt; b.createdAt.compareTo(a.createdAt));
      return stories;
    });
  }
  
  /// Update user statistics
  Future&lt;void&gt; _updateUserStats(
    String userId, {
    int? postsCreated,
    int? commentsCreated,
    int? reputationChange,
  }) async {
    final userRef = _db.ref('users/$userId');
    
    await userRef.runTransaction((Object? user) {
      if (user == null) return Transaction.abort();
      
      final userData = Map&lt;String, dynamic&gt;.from(user as Map);
      
      if (postsCreated != null) {
        userData['totalPosts'] = (userData['totalPosts'] ?? 0) + postsCreated;
      }
      
      if (commentsCreated != null) {
        userData['totalComments'] = 
            (userData['totalComments'] ?? 0) + commentsCreated;
      }
      
      if (reputationChange != null) {
        userData['reputation'] = 
            (userData['reputation'] ?? 0) + reputationChange;
      }
      
      return Transaction.success(userData);
    });
  }
}

// Provider
final communityServiceProvider = Provider&lt;CommunityService&gt;((ref) {
  return CommunityService();
});
        </pre>
        
        <h3>üìö Reference Web App Code</h3>
        <ul>
            <li><strong>Community Component:</strong> <code>src/components/Community.tsx</code> - Lines 1-800</li>
            <li><strong>Real-time Listeners:</strong> Lines 87-145 (useEffect hooks)</li>
            <li><strong>Voting Logic:</strong> Lines 450-520 (handleVote function)</li>
            <li><strong>Post Creation:</strong> <code>src/components/CreatePostModal.tsx</code></li>
            <li><strong>Firebase Structure:</strong> Check existing Firebase Console</li>
        </ul>
        
        <h3>‚ö†Ô∏è Critical Considerations</h3>
        <ul>
            <li><strong>Race Conditions:</strong> Always use Transactions for voting to prevent data loss</li>
            <li><strong>Real-time Performance:</strong> Limit queries to 20-50 items, implement pagination</li>
            <li><strong>Memory Management:</strong> Cancel stream subscriptions on dispose</li>
            <li><strong>Image Upload:</strong> Integrate with ImgBB API (max 32MB)</li>
            <li><strong>Story Cleanup:</strong> Implement background job to delete expired stories</li>
        </ul>
        
        <h3>‚úÖ Testing Checklist</h3>
        <ul>
            <li>‚úì Posts load in real-time without delays</li>
            <li>‚úì Voting works correctly with transactions</li>
            <li>‚úì Comment count updates properly</li>
            <li>‚úì Stories expire after 24 hours</li>
            <li>‚úì Channel filtering works correctly</li>
            <li>‚úì User stats update after actions</li>
            <li>‚úì No memory leaks from stream subscriptions</li>
        </ul>
        
        <h3>üîó Dependencies</h3>
        <p><strong>Required:</strong> Firebase Realtime Database, Auth Service, Post/Comment models</p>
        <p><strong>Blocks:</strong> Community UI, Post Cards, Comments Screen</p>
    </div></div>
    <div id="community-main-ui-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Community Screen Main UI Guide</h2>
        <p><strong>Assignee:</strong> Manar</p>
        <p><strong>Goal:</strong> Build the main UI for the community screen based on the Figma design.</p>
        <h4>Steps:</h4><ol><li>Create `community_screen.dart`.</li><li>Implement the main layout, channel tabs, and search/sort controls.</li></ol>
    </div></div>
    <div id="stories-ui-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Stories Feature UI Guide</h2>
        <p><strong>Assignee:</strong> Ahmed</p>
        <p><strong>Goal:</strong> Implement the UI for the Stories feature.</p>
        <h4>Steps:</h4><ol><li>Create a `stories_bar.dart` widget.</li><li>Create a `story_circle.dart` widget.</li><li>Create a `story_viewer.dart` screen for a full-screen, auto-advancing story view.</li><li>Implement the UI for the `create_story_modal.dart`.</li></ol>
    </div></div>
    <div id="community-state-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Community State & UI Integration Guide</h2>
        <p><strong>Assignees:</strong> Mohamed & Manar</p>
        <p><strong>Goal:</strong> Manage the state for the community screen and connect the UI to the data services.</p>
        <h4>Steps:</h4><ol><li><strong>(Mohamed)</strong> Create a `CommunityBLoC` or `CommunityNotifier`.</li><li><strong>(Mohamed)</strong> Implement lazy loading using a `ScrollController`.</li><li><strong>(Manar)</strong> Connect the UI widgets to the state management solution.</li><li><strong>(Mohamed)</strong> Implement the voting logic in the BLoC using an optimistic update pattern.</li></ol>
    </div></div>
    <div id="post-detail-comments-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Post Detail & Comments Guide</h2>
        <p><strong>Assignee:</strong> Ahmed</p>
        <p><strong>Goal:</strong> Build the screen for viewing a single post and its comments.</p>
        <h4>Steps:</h4><ol><li>Create `post_detail_screen.dart`.</li><li>Display the full post content and a `ListView` for comments.</li><li>Add a `TextFormField` and a "Send" button to add new comments.</li></ol>
    </div></div>
    <div id="post-card-widget-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Post Card Widget Guide</h2>
        <p><strong>Assignee:</strong> Manar</p>
        <p><strong>Goal:</strong> Create a reusable widget for displaying a single post in the feed.</p>
        <h4>Steps:</h4><ol><li>Create `post_card.dart`.</li><li>Display post title, snippet, author, vote count, etc., based on Figma.</li></ol>
    </div></div>
    <div id="deep-linking-sharing-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>Deep Linking & Sharing Guide</h2>
        <p><strong>Assignees:</strong> All</p>
        <p><strong>Goal:</strong> Implement deep linking to open specific posts from a URL and share them.</p>
        <h4>Packages:</h4><ul><li>`go_router`</li><li>`share_plus`</li></ul>
        <h4>Steps:</h4><ol><li>Configure `go_router` to handle a route like `/community/post/:postId`.</li><li>Implement the "Share" button to generate the URL and use `share_plus`.</li></ol>
    </div></div>

    <!-- WEEK 3-5 TASKS -->
    <div id="e2e-testing-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>üß™ End-to-End Testing Guide</h2>
        <p><strong>üë• Team:</strong> All | <strong>‚è±Ô∏è Duration:</strong> 3 Days | <strong>üìÖ Days:</strong> Oct 31 - Nov 2</p>
        
        <h3>üéØ Goal</h3>
        <p>Conduct comprehensive testing to ensure all features work correctly on both iOS and Android devices.</p>
        
        <h3>üìã Testing Scenarios</h3>
        
        <h4>1. Authentication Flow Testing (Mohamed)</h4>
        <ul>
            <li><strong>Test Case 1.1:</strong> New user signs in with Google ‚Üí Profile created ‚Üí Redirects to scan screen</li>
            <li><strong>Test Case 1.2:</strong> User continues as guest ‚Üí Limited to 5 scans ‚Üí Prompted to sign in after limit</li>
            <li><strong>Test Case 1.3:</strong> User signs out ‚Üí Returns to welcome screen ‚Üí Data cleared</li>
            <li><strong>Test Case 1.4:</strong> User closes app while signed in ‚Üí Reopens ‚Üí Still signed in (persistence)</li>
            <li><strong>Test Case 1.5:</strong> Network error during sign-in ‚Üí Shows error message ‚Üí Retry works</li>
        </ul>
        
        <h4>2. Scan Feature Testing (Ahmed)</h4>
        <ul>
            <li><strong>Test Case 2.1:</strong> Take photo with camera ‚Üí AI analysis ‚Üí Results display correctly</li>
            <li><strong>Test Case 2.2:</strong> Choose from gallery ‚Üí Analysis works ‚Üí History saved</li>
            <li><strong>Test Case 2.3:</strong> Upload non-plant image ‚Üí "Not a plant" error shown</li>
            <li><strong>Test Case 2.4:</strong> Poor network connection ‚Üí Loading indicator ‚Üí Timeout after 30s</li>
            <li><strong>Test Case 2.5:</strong> Reach scan limit ‚Üí Modal shown ‚Üí Upgrade prompt displayed</li>
            <li><strong>Test Case 2.6:</strong> View scan history ‚Üí Images load ‚Üí Tap to view details</li>
            <li><strong>Test Case 2.7:</strong> Product recommendation ‚Üí Navigate to marketplace ‚Üí Product shown</li>
        </ul>
        
        <h4>3. Community Testing (All)</h4>
        <ul>
            <li><strong>Test Case 3.1:</strong> Create post with image ‚Üí Uploads to ImgBB ‚Üí Post appears in feed</li>
            <li><strong>Test Case 3.2:</strong> Vote on post ‚Üí Count updates immediately ‚Üí Refreshing maintains vote</li>
            <li><strong>Test Case 3.3:</strong> Add comment ‚Üí Comment appears in real-time</li>
            <li><strong>Test Case 3.4:</strong> Create story ‚Üí Expires after 24 hours ‚Üí Removed from feed</li>
            <li><strong>Test Case 3.5:</strong> Switch channels ‚Üí Posts filter correctly</li>
            <li><strong>Test Case 3.6:</strong> Guest mode ‚Üí Can view posts ‚Üí Cannot create/vote (disabled)</li>
        </ul>
        
        <h4>4. Marketplace Testing (Manar & Mohamed)</h4>
        <ul>
            <li><strong>Test Case 4.1:</strong> Browse products ‚Üí Grid/List view toggle ‚Üí Images load</li>
            <li><strong>Test Case 4.2:</strong> Search products ‚Üí Results filter correctly</li>
            <li><strong>Test Case 4.3:</strong> Add to cart ‚Üí Counter updates ‚Üí Cart screen shows item</li>
            <li><strong>Test Case 4.4:</strong> Checkout flow ‚Üí PayPal payment ‚Üí Order created</li>
            <li><strong>Test Case 4.5:</strong> Guest attempts purchase ‚Üí Prompted to sign in</li>
        </ul>
        
        <h3>üì± Device Testing Matrix</h3>
        <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
            <tr style="background: #f3f4f6;">
                <th style="padding: 10px; border: 1px solid #d1d5db;">Platform</th>
                <th style="padding: 10px; border: 1px solid #d1d5db;">Device</th>
                <th style="padding: 10px; border: 1px solid #d1d5db;">OS Version</th>
                <th style="padding: 10px; border: 1px solid #d1d5db;">Tester</th>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #d1d5db;">iOS</td>
                <td style="padding: 10px; border: 1px solid #d1d5db;">iPhone 12 Pro</td>
                <td style="padding: 10px; border: 1px solid #d1d5db;">iOS 17+</td>
                <td style="padding: 10px; border: 1px solid #d1d5db;">Ahmed</td>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #d1d5db;">Android</td>
                <td style="padding: 10px; border: 1px solid #d1d5db;">Samsung Galaxy S21</td>
                <td style="padding: 10px; border: 1px solid #d1d5db;">Android 12+</td>
                <td style="padding: 10px; border: 1px solid #d1d5db;">Mohamed</td>
            </tr>
            <tr>
                <td style="padding: 10px; border: 1px solid #d1d5db;">Android</td>
                <td style="padding: 10px; border: 1px solid #d1d5db;">Xiaomi Redmi</td>
                <td style="padding: 10px; border: 1px solid #d1d5db;">Android 11</td>
                <td style="padding: 10px; border: 1px solid #d1d5db;">Manar</td>
            </tr>
        </table>
        
        <h3>üìù Bug Tracking Template</h3>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
Bug ID: [BUG-001]
Title: [Brief description]
Severity: Critical / High / Medium / Low
Platform: iOS / Android / Both
Steps to Reproduce:
  1. ...
  2. ...
Expected Result: [What should happen]
Actual Result: [What actually happens]
Screenshots: [Attach if applicable]
Assignee: [Team member]
Status: Open / In Progress / Resolved / Won't Fix
        </pre>
        
        <h3>‚úÖ Testing Completion Criteria</h3>
        <ul>
            <li>‚úì All critical test cases pass (100%)</li>
            <li>‚úì All high-priority bugs fixed</li>
            <li>‚úì App tested on at least 3 physical devices</li>
            <li>‚úì No crashes during 30-minute continuous usage</li>
            <li>‚úì All API calls complete within 10 seconds</li>
            <li>‚úì Camera works on all test devices</li>
            <li>‚úì Payment flow completes successfully</li>
        </ul>
    </div></div>
    
    <div id="performance-optimization-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>‚ö° Performance Optimization Guide</h2>
        <p><strong>üë• Team:</strong> All | <strong>‚è±Ô∏è Duration:</strong> 2 Days | <strong>üìÖ Days:</strong> Nov 3-4</p>
        
        <h3>üéØ Performance Targets</h3>
        <ul>
            <li><strong>App Startup:</strong> &lt; 3 seconds (cold start)</li>
            <li><strong>Screen Transitions:</strong> &lt; 100ms</li>
            <li><strong>API Calls:</strong> &lt; 5 seconds (AI analysis &lt; 15s)</li>
            <li><strong>Image Loading:</strong> &lt; 2 seconds</li>
            <li><strong>Memory Usage:</strong> &lt; 200MB average</li>
            <li><strong>Battery Drain:</strong> &lt; 5% per hour active use</li>
        </ul>
        
        <h3>üîß Optimization Checklist</h3>
        
        <h4>1. Image Optimization (Ahmed & Manar)</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// Image compression before upload
import 'package:image/image.dart' as img;

Future&lt;File&gt; compressImage(File file) async {
  final bytes = await file.readAsBytes();
  final image = img.decodeImage(bytes);
  
  if (image == null) return file;
  
  // Resize if larger than 1920x1080
  final resized = img.copyResize(image, 
    width: image.width &gt; 1920 ? 1920 : null,
    height: image.height &gt; 1080 ? 1080 : null,
  );
  
  // Compress to 85% quality
  final compressed = img.encodeJpg(resized, quality: 85);
  
  final tempDir = await getTemporaryDirectory();
  final compressedFile = File('${tempDir.path}/compressed_${DateTime.now().millisecondsSinceEpoch}.jpg');
  await compressedFile.writeAsBytes(compressed);
  
  return compressedFile;
}

// Use cached_network_image for all remote images
CachedNetworkImage(
  imageUrl: imageUrl,
  placeholder: (context, url) => Shimmer.fromColors(
    baseColor: Colors.grey[300]!,
    highlightColor: Colors.grey[100]!,
    child: Container(color: Colors.white),
  ),
  errorWidget: (context, url, error) => Icon(Icons.error),
  memCacheHeight: 800, // Limit memory cache size
)
        </pre>
        
        <h4>2. State Management Optimization (Mohamed)</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
// Use select() to rebuild only when specific values change
final userName = ref.watch(userProvider.select((user) => user?.displayName));

// Dispose streams properly
@override
void dispose() {
  _postsSubscription?.cancel();
  _commentsSubscription?.cancel();
  super.dispose();
}

// Implement lazy loading for lists
class CommunityScreen extends ConsumerStatefulWidget {
  @override
  _CommunityScreenState createState() => _CommunityScreenState();
}

class _CommunityScreenState extends ConsumerState&lt;CommunityScreen&gt; {
  final _scrollController = ScrollController();
  int _limit = 20;
  
  @override
  void initState() {
    super.initState();
    _scrollController.addListener(_onScroll);
  }
  
  void _onScroll() {
    if (_scrollController.position.pixels &gt;= 
        _scrollController.position.maxScrollExtent * 0.8) {
      setState(() => _limit += 20);
    }
  }
}
        </pre>
        
        <h4>3. Build Optimization (All)</h4>
        <ul>
            <li><strong>Use const constructors:</strong> Wrap static widgets with <code>const</code></li>
            <li><strong>Avoid rebuilds:</strong> Extract widgets to separate classes</li>
            <li><strong>Use ListView.builder:</strong> Never use ListView with all items at once</li>
            <li><strong>Implement AutomaticKeepAliveClientMixin:</strong> For tabs that shouldn't rebuild</li>
        </ul>
        
        <h3>üìä Performance Testing Tools</h3>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
# Flutter DevTools
flutter pub global activate devtools
flutter pub global run devtools

# Performance Profiling
flutter run --profile
# Then use DevTools to analyze:
# - Timeline (frame rendering)
# - Memory usage
# - CPU profiling
# - Network calls

# Build size analysis
flutter build apk --analyze-size
flutter build ios --analyze-size
        </pre>
        
        <h3>‚úÖ Optimization Completion Checklist</h3>
        <ul>
            <li>‚úì No frames dropped (60 FPS maintained)</li>
            <li>‚úì Images compressed before upload</li>
            <li>‚úì All lists use lazy loading</li>
            <li>‚úì Memory usage stable (no leaks)</li>
            <li>‚úì App size &lt; 50MB (Android) / &lt; 100MB (iOS)</li>
            <li>‚úì Battery drain acceptable</li>
        </ul>
    </div></div>
    
    <div id="app-store-prep-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>üè™ App Store Preparation Guide</h2>
        <p><strong>üë• Team:</strong> All | <strong>‚è±Ô∏è Duration:</strong> 3 Days | <strong>üìÖ Days:</strong> Nov 7-9</p>
        
        <h3>üéØ Goal</h3>
        <p>Prepare all assets and information required for App Store and Google Play Store submissions.</p>
        
        <h3>üì± iOS App Store Requirements</h3>
        
        <h4>1. Screenshots (Required Sizes)</h4>
        <ul>
            <li><strong>6.5" Display (iPhone 14 Pro Max):</strong> 1290 x 2796 pixels (2-10 screenshots)</li>
            <li><strong>5.5" Display (iPhone 8 Plus):</strong> 1242 x 2208 pixels (2-10 screenshots)</li>
            <li><strong>12.9" iPad Pro:</strong> 2048 x 2732 pixels (optional)</li>
        </ul>
        
        <h4>2. App Store Information</h4>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
App Name: Naptah - Plant Disease Detector

Subtitle: AI-Powered Agricultural Assistant

Keywords: plant,disease,agriculture,AI,farming,Egypt,crops

Description (Arabic):
ŸÜÿ®ÿ™Ÿá ŸáŸà ÿ™ÿ∑ÿ®ŸäŸÇ ÿ∞ŸÉŸä ŸÑÿßŸÉÿ™ÿ¥ÿßŸÅ ÿ£ŸÖÿ±ÿßÿ∂ ÿßŸÑŸÜÿ®ÿßÿ™ÿßÿ™ ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä...
[Write compelling 4000-character description]

Description (English):
Naptah is an AI-powered plant disease detection app designed for Egypt's 
agricultural community. With 95% accuracy, instant diagnosis, and expert 
treatment recommendations...
[Write compelling 4000-character description]

Privacy Policy URL: https://naaptaa.netlify.app/privacy
Support URL: https://naaptaa.netlify.app/support
        </pre>
        
        <h4>3. Build Configuration</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
# iOS Build
flutter build ios --release

# Archive in Xcode:
# 1. Open ios/Runner.xcworkspace in Xcode
# 2. Product ‚Üí Archive
# 3. Distribute App ‚Üí App Store Connect
# 4. Upload
        </pre>
        
        <h3>ü§ñ Google Play Store Requirements</h3>
        
        <h4>1. Screenshots (Required Sizes)</h4>
        <ul>
            <li><strong>Phone:</strong> 1080 x 1920 pixels minimum (2-8 screenshots)</li>
            <li><strong>7" Tablet:</strong> 1024 x 600 pixels (optional)</li>
            <li><strong>10" Tablet:</strong> 1280 x 800 pixels (optional)</li>
        </ul>
        
        <h4>2. Feature Graphic</h4>
        <ul>
            <li><strong>Size:</strong> 1024 x 500 pixels</li>
            <li><strong>Format:</strong> JPG or PNG</li>
            <li><strong>Content:</strong> App logo + tagline + visual</li>
        </ul>
        
        <h4>3. Store Listing</h4>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
Short Description (80 chars):
AI plant doctor for Egyptian farmers - 95% accurate disease detection

Full Description (4000 chars):
üå± Naptah - Your Plant's Personal Doctor

Detect plant diseases instantly with AI-powered analysis...
[Write engaging description with emojis and bullet points]

Category: Productivity
Content Rating: Everyone
        </pre>
        
        <h4>4. Build Configuration</h4>
        <pre style="background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto;">
# Android Build (App Bundle)
flutter build appbundle --release

# Or APK
flutter build apk --release --split-per-abi

# Sign the build
# Configure android/key.properties with keystore info
        </pre>
        
        <h3>üìÑ Required Documents</h3>
        <ul>
            <li><strong>Privacy Policy:</strong> Must include data collection, usage, and sharing policies</li>
            <li><strong>Terms of Service:</strong> User agreements and liability clauses</li>
            <li><strong>Test Account Credentials:</strong> For app review (username/password)</li>
            <li><strong>App Icon:</strong> 1024x1024 PNG (iOS), Adaptive Icon (Android)</li>
        </ul>
        
        <h3>‚úÖ Submission Checklist</h3>
        <ul>
            <li>‚úì All screenshots captured and optimized</li>
            <li>‚úì Store descriptions written in Arabic and English</li>
            <li>‚úì Privacy policy and terms published</li>
            <li>‚úì App icons created (all sizes)</li>
            <li>‚úì Test account ready with sample data</li>
            <li>‚úì Build signed and uploaded</li>
            <li>‚úì All permissions explained in description</li>
            <li>‚úì Contact email configured</li>
        </ul>
    </div></div>
    
    <div id="presentation-creation-guide" class="modal"><div class="modal-content"><span class="close-btn">&times;</span>
        <h2>üé§ Presentation Creation Guide</h2>
        <p><strong>üë• Team:</strong> Ahmed & Manar | <strong>‚è±Ô∏è Duration:</strong> 7 Days | <strong>üìÖ Days:</strong> Nov 14-20</p>
        
        <h3>üéØ Goal</h3>
        <p>Create a compelling 5-7 minute presentation showcasing the Naptah Flutter app with demo, technical overview, and team introduction.</p>
        
        <h3>üìä Presentation Structure (12-15 Slides)</h3>
        
        <h4>Slide 1: Title Slide</h4>
        <ul>
            <li>App logo and name</li>
            <li>Tagline: "Your Plant's Personal Doctor"</li>
            <li>Team names and roles</li>
        </ul>
        
        <h4>Slides 2-3: Problem Statement</h4>
        <ul>
            <li>Egyptian agricultural challenges</li>
            <li>Plant disease impact on crops and income</li>
            <li>Lack of accessible expert diagnosis</li>
            <li>Statistics: 20-30% crop loss due to diseases</li>
        </ul>
        
        <h4>Slides 4-5: Solution Overview</h4>
        <ul>
            <li>AI-powered plant disease detection (95% accuracy)</li>
            <li>Instant diagnosis in seconds</li>
            <li>Community knowledge sharing</li>
            <li>Integrated marketplace for treatments</li>
        </ul>
        
        <h4>Slides 6-8: Live Demo / Screenshots</h4>
        <ul>
            <li><strong>Demo 1:</strong> Take photo ‚Üí AI analysis ‚Üí Results ‚Üí Recommendations</li>
            <li><strong>Demo 2:</strong> Community post creation ‚Üí Real-time updates</li>
            <li><strong>Demo 3:</strong> Marketplace browsing ‚Üí Add to cart ‚Üí Checkout</li>
        </ul>
        
        <h4>Slide 9: Technical Architecture</h4>
        <ul>
            <li>Flutter + Dart (cross-platform)</li>
            <li>Firebase (auth, database)</li>
            <li>Google Gemini 2.0 Flash (AI)</li>
            <li>PayPal (payments)</li>
            <li>Riverpod (state management)</li>
        </ul>
        
        <h4>Slide 10: Key Features</h4>
        <ul>
            <li>‚úì 50+ disease detection</li>
            <li>‚úì Real-time community</li>
            <li>‚úì Product recommendations</li>
            <li>‚úì Scan history</li>
            <li>‚úì Expert consultations</li>
            <li>‚úì Arabic/English support</li>
        </ul>
        
        <h4>Slide 11: Development Journey</h4>
        <ul>
            <li>5-week sprint timeline</li>
            <li>3-person team collaboration</li>
            <li>Challenges overcome</li>
            <li>Lessons learned</li>
        </ul>
        
        <h4>Slide 12: Impact & Metrics</h4>
        <ul>
            <li>Target: 10,000+ downloads in 3 months</li>
            <li>95% AI accuracy</li>
            <li>500+ marketplace products</li>
            <li>Support for Egyptian farmers</li>
        </ul>
        
        <h4>Slide 13: Team Introduction</h4>
        <ul>
            <li><strong>Ahmed:</strong> Lead Developer - Scan features</li>
            <li><strong>Mohamed:</strong> Backend & Services - Auth, APIs</li>
            <li><strong>Manar:</strong> UI/UX - Marketplace, Community</li>
        </ul>
        
        <h4>Slide 14: Future Roadmap</h4>
        <ul>
            <li>Offline mode for rural areas</li>
            <li>Pest identification</li>
            <li>Weather integration</li>
            <li>Crop yield prediction</li>
        </ul>
        
        <h4>Slide 15: Thank You & Q&A</h4>
        <ul>
            <li>Contact information</li>
            <li>App download links</li>
            <li>Social media</li>
        </ul>
        
        <h3>üé¨ Demo Video Recording (3-4 minutes)</h3>
        <pre style="background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto;">
Recording Checklist:
‚ñ° Record in landscape mode (1920x1080)
‚ñ° Use screen recording tool (OBS Studio / QuickTime)
‚ñ° Show app on physical device (not simulator)
‚ñ° Include voice-over narration (Arabic or English)
‚ñ° Demonstrate 3 key flows:
  1. Sign in ‚Üí Scan plant ‚Üí Get results (60s)
  2. Browse community ‚Üí Create post (45s)
  3. Marketplace ‚Üí Add to cart ‚Üí Checkout (45s)
‚ñ° Add background music (low volume)
‚ñ° Include text overlays for key features
‚ñ° Export in MP4 format (H.264 codec)
        </pre>
        
        <h3>üé® Design Tips (Canva)</h3>
        <ul>
            <li>Use Naptah brand colors: #10b981 (green), #047857 (dark green)</li>
            <li>Include app screenshots and UI mockups</li>
            <li>Add icons and illustrations for visual appeal</li>
            <li>Keep text minimal (bullet points, not paragraphs)</li>
            <li>Use consistent fonts (Poppins or similar)</li>
            <li>Add animations/transitions between slides</li>
        </ul>
        
        <h3>üé§ Presentation Delivery Tips</h3>
        <ul>
            <li><strong>Practice:</strong> Rehearse 3-5 times before final presentation</li>
            <li><strong>Timing:</strong> Aim for 5-7 minutes total</li>
            <li><strong>Backup:</strong> Have offline video ready in case of technical issues</li>
            <li><strong>Confidence:</strong> Speak clearly, make eye contact, smile</li>
            <li><strong>Demo:</strong> Test app on multiple devices before presentation</li>
        </ul>
        
        <h3>‚úÖ Presentation Checklist</h3>
        <ul>
            <li>‚úì All slides created in Canva</li>
            <li>‚úì Demo video recorded and edited</li>
            <li>‚úì Voice-over narration added</li>
            <li>‚úì Presentation rehearsed 3+ times</li>
            <li>‚úì Backup video exported</li>
            <li>‚úì Team roles assigned (who speaks when)</li>
            <li>‚úì Q&A preparation done</li>
        </ul>
    </div></div>

    <script src="script.js"></script>
</body>
</html>